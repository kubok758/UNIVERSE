<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNIVERSE: PRO</title>
    <style>
        body {
            margin: 0;
            background-color: #000005;
            background-image: radial-gradient(circle at 50% 50%, #0b0b1a 0%, #000000 100%);
            color: white;
            font-family: 'Courier New', Courier, monospace;
            overflow-x: hidden;
        }

        /* ИНТЕРФЕЙС */
        .hud {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border: 1px solid #00d2ff;
            box-shadow: 0 0 15px rgba(0, 210, 255, 0.2);
            backdrop-filter: blur(5px);
        }

        h1 { margin: 0 0 10px; font-size: 1.2rem; color: #00d2ff; letter-spacing: 2px; }
        .hud-text { font-size: 0.9rem; color: #ccc; margin: 2px 0; }
        .seed-input { 
            background: transparent; border: none; border-bottom: 1px solid #555; 
            color: #fff; width: 60px; text-align: center; font-family: inherit;
        }

        /* СТИЛИ КОСМОСА */
        .universe-container {
            width: 100%;
            position: relative;
            perspective: 1px; /* Нужно для параллакса, если делать через CSS 3D */
            /* Мы будем делать JS параллакс, так что здесь просто контейнер */
        }

        .sector {
            position: relative;
            width: 100%;
            height: 80vh; 
            overflow: hidden;
        }

        /* Общие стили объектов */
        .space-object {
            position: absolute;
            will-change: transform; /* Оптимизация для браузера */
        }

        .star { background: white; border-radius: 50%; opacity: 0.9; z-index: 1; }
        
        .nebula {
            border-radius: 50%;
            filter: blur(50px);
            opacity: 0.3;
            z-index: 0; /* На заднем плане */
        }

        .planet {
            border-radius: 50%;
            box-shadow: inset -15px -15px 30px rgba(0,0,0,0.95), 0 0 15px rgba(255,255,255,0.15);
            cursor: pointer;
            z-index: 10; /* На переднем плане */
            transition: filter 0.3s;
        }
        .planet:hover { filter: brightness(1.3); }

        /* МОДАЛЬНОЕ ОКНО ДАННЫХ */
        .data-modal {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 300px;
            background: rgba(10, 15, 30, 0.95);
            border: 2px solid #00d2ff;
            padding: 20px;
            z-index: 2000;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: center;
            box-shadow: 0 0 50px rgba(0, 210, 255, 0.3);
        }
        .data-modal.active { transform: translate(-50%, -50%) scale(1); }
        .data-modal h2 { color: #00d2ff; margin-top: 0; }
        .data-modal button {
            margin-top: 15px;
            background: #00d2ff; border: none; padding: 8px 20px;
            cursor: pointer; font-weight: bold;
        }

        .trigger { height: 10px; width: 100%; opacity: 0; }

    </style>
</head>
<body>

    <div class="hud">
        <h1>UNIVERSE OS</h1>
        <p class="hud-text">Distance: <span id="distVal">0</span> LY</p>
        <p class="hud-text">Seed: <input type="number" id="seedInput" class="seed-input" value="1234"></p>
        <p class="hud-text" style="font-size: 10px; color: #555;">(Reload to apply seed)</p>
    </div>

    <div class="data-modal" id="modal">
        <h2 id="mTitle">PLANET NAME</h2>
        <p id="mDesc" style="color: #aaa; font-size: 0.9rem;"></p>
        <button onclick="closeModal()">CLOSE LOG</button>
    </div>

    <div class="universe-container" id="universe"></div>
    <div class="trigger" id="trigger"></div>

    <script>
        // --- 1. SEED SYSTEM (ГЕНЕРАТОР СЛУЧАЙНЫХ ЧИСЕЛ) ---
        // Чтобы вселенная была одинаковой для всех, кто введет одинаковый Seed
        
        let currentSeed = parseInt(document.getElementById('seedInput').value) || 1234;

        // Простой алгоритм генерации псевдослучайных чисел (LCG)
        function seededRandom() {
            currentSeed = (currentSeed * 9301 + 49297) % 233280;
            return currentSeed / 233280;
        }

        // Обёртка, чтобы получать число от min до max
        function random(min, max) {
            return min + seededRandom() * (max - min);
        }

        // Выбор случайного элемента из массива
        function randomChoice(arr) {
            return arr[Math.floor(random(0, arr.length))];
        }

        // --- ГЕНЕРАТОР ИМЕН И СВОЙСТВ ---
        function generatePlanetData() {
            const names = ['Xenon', 'Aria', 'Terra', 'Kryo', 'Zeus', 'Odin', 'Ragnar', 'Nova', 'C-137'];
            const suffixes = ['Prime', 'IV', 'b', 'Alpha', 'Zero', 'X'];
            const types = ['Gas Giant', 'Ice World', 'Desert', 'Oceanic', 'Volcanic'];
            
            return {
                name: `${randomChoice(names)}-${randomChoice(suffixes)}`,
                type: randomChoice(types),
                temp: Math.floor(random(-200, 500)) + '°C',
                gravity: random(0.5, 2.5).toFixed(2) + ' G'
            };
        }

        // --- ОСНОВНАЯ ЛОГИКА ---
        const universe = document.getElementById('universe');
        const distVal = document.getElementById('distVal');
        const modal = document.getElementById('modal');
        let totalDistance = 0;
        
        // Массив для хранения объектов параллакса (чтобы двигать их при скролле)
        let parallaxObjects = [];

        function randomColor() {
            const h = random(0, 360);
            return `hsl(${h}, ${random(50, 80)}%, ${random(40, 60)}%)`;
        }

        function createSector() {
            const sector = document.createElement('div');
            sector.classList.add('sector');

            const fragment = document.createDocumentFragment();

            // 1. Туманности (Дальний фон)
            if (random(0, 1) > 0.6) {
                const nebula = document.createElement('div');
                nebula.classList.add('space-object', 'nebula');
                nebula.style.width = random(300, 700) + 'px';
                nebula.style.height = random(300, 700) + 'px';
                nebula.style.left = random(-20, 80) + '%';
                nebula.style.top = random(0, 80) + '%';
                nebula.style.background = randomColor();
                
                // Добавляем в параллакс (медленная скорость)
                // initialTop нужно запомнить, чтобы от него считать смещение
                nebula.dataset.speed = "0.2"; 
                fragment.appendChild(nebula);
            }

            // 2. Звезды (Обычный слой)
            const starCount = Math.floor(random(10, 30));
            for(let i=0; i<starCount; i++) {
                const star = document.createElement('div');
                star.classList.add('space-object', 'star');
                const size = random(1, 3);
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.left = random(0, 100) + '%';
                star.style.top = random(0, 100) + '%';
                star.style.opacity = random(0.5, 1);
                fragment.appendChild(star);
            }

            // 3. Планеты (Ближний план)
            if (random(0, 1) > 0.7) {
                const planet = document.createElement('div');
                planet.classList.add('space-object', 'planet');
                const size = random(60, 150);
                
                planet.style.width = size + 'px';
                planet.style.height = size + 'px';
                planet.style.left = random(10, 80) + '%';
                planet.style.top = random(10, 80) + '%';
                planet.style.background = randomColor();
                
                // ДАННЫЕ ПЛАНЕТЫ
                const data = generatePlanetData();
                planet.onclick = () => showModal(data);

                // Параллакс (быстрая скорость)
                planet.dataset.speed = "0.15"; // Двигаем чуть-чуть относительно скролла
                fragment.appendChild(planet);
            }

            sector.appendChild(fragment);
            universe.appendChild(sector);
            totalDistance += Math.floor(random(100, 300));
            distVal.innerText = totalDistance.toLocaleString();

            // Собираем новые элементы для параллакса
            const newParallaxItems = sector.querySelectorAll('.nebula, .planet');
            newParallaxItems.forEach(el => {
                // Запоминаем начальную позицию относительно страницы
                // (упрощенно: просто добавляем в массив для обработки)
                parallaxObjects.push(el);
            });
        }

        // --- ПАРАЛЛАКС ЭФФЕКТ ---
        // Срабатывает при каждом движении колесика
        window.addEventListener('scroll', () => {
            const scrollY = window.scrollY;

            // Мы не двигаем КАЖДУЮ звезду (это убьет процессор)
            // Мы двигаем только большие объекты (планеты и туманности)
            parallaxObjects.forEach(el => {
                const speed = parseFloat(el.dataset.speed);
                // Формула: сдвигаем элемент вниз или вверх в зависимости от скролла
                // Чтобы создать ощущение глубины
                const offset = scrollY * speed; 
                
                // Для планет (ближе) - двигаем ВВЕРХ быстрее (как будто пролетаем мимо)
                // Для туманностей (дальше) - почти не двигаем
                
                if (el.classList.contains('planet')) {
                    el.style.transform = `translateY(${offset * -0.5}px)`; 
                } else {
                    el.style.transform = `translateY(${offset * 0.2}px)`;
                }
            });
        });

        // --- ИНТЕРАКТИВНОСТЬ (МОДАЛКА) ---
        function showModal(data) {
            document.getElementById('mTitle').innerText = "SYSTEM: " + data.name;
            document.getElementById('mDesc').innerHTML = `
                Type: ${data.type}<br>
                Gravity: ${data.gravity}<br>
                Surface Temp: ${data.temp}<br>
                <br>Status: Discovery logged.
            `;
            modal.classList.add('active');
        }

        function closeModal() {
            modal.classList.remove('active');
        }

        // --- ЗАГРУЗКА ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Грузим пачками
                    for(let i=0; i<3; i++) createSector();
                }
            });
        }, { rootMargin: '200px' });

        // Инициализация
        for(let i=0; i<4; i++) createSector();
        observer.observe(document.getElementById('trigger'));

    </script>
</body>
</html>

